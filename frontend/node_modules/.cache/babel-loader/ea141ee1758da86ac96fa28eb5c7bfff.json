{"ast":null,"code":"import WalletConnect from \"@deficonnect/client\";\nimport QRCodeModal from \"@deficonnect/qrcode-modal\";\nimport HttpConnection from \"@deficonnect/http-connection\";\nimport { payloadId, signingMethods, parsePersonalSign, getRpcUrl } from \"@deficonnect/utils\";\n\nconst ProviderEngine = require(\"web3-provider-engine\");\n\nconst CacheSubprovider = require(\"web3-provider-engine/subproviders/cache\");\n\nconst FixtureSubprovider = require(\"web3-provider-engine/subproviders/fixture\");\n\nconst FilterSubprovider = require(\"web3-provider-engine/subproviders/filters\");\n\nconst HookedWalletSubprovider = require(\"web3-provider-engine/subproviders/hooked-wallet\");\n\nconst NonceSubprovider = require(\"web3-provider-engine/subproviders/nonce-tracker\");\n\nconst SubscriptionsSubprovider = require(\"web3-provider-engine/subproviders/subscriptions\");\n\nfunction parseToETHChainId(chainId) {\n  try {\n    const parsed = parseInt(chainId !== null && chainId !== void 0 ? chainId : \"0\");\n\n    if (isNaN(parsed)) {\n      return \"0\";\n    } else {\n      return chainId !== null && chainId !== void 0 ? chainId : \"0\";\n    }\n  } catch (error) {\n    return \"0\";\n  }\n}\n\nclass WalletConnectProvider extends ProviderEngine {\n  constructor(opts) {\n    super({\n      pollingInterval: opts.pollingInterval || 8000\n    });\n    this.bridge = \"https://bridge.walletconnect.org\";\n    this.qrcode = true;\n    this.qrcodeModal = QRCodeModal;\n    this.qrcodeModalOptions = undefined;\n    this.rpc = null;\n    this.infuraId = \"\";\n    this.http = null;\n    this.isConnecting = false;\n    this.connected = false;\n    this.connectCallbacks = [];\n    this.accounts = [];\n    this.chainId = \"1\";\n    this.rpcUrl = \"\";\n\n    this.enable = async () => {\n      const wc = await this.getWalletConnector();\n\n      if (wc) {\n        this.start();\n        this.subscribeWalletConnector();\n        return wc.accounts;\n      } else {\n        throw new Error(\"Failed to connect to WalleConnect\");\n      }\n    };\n\n    this.request = async payload => {\n      return this.send(payload);\n    };\n\n    this.send = async (payload, callback) => {\n      if (typeof payload === \"string\") {\n        const method = payload;\n        let params = callback;\n\n        if (method === \"personal_sign\") {\n          params = parsePersonalSign(params);\n        }\n\n        return this.sendAsyncPromise(method, params);\n      }\n\n      payload = Object.assign({\n        id: payloadId(),\n        jsonrpc: \"2.1\"\n      }, payload);\n\n      if (payload.method === \"personal_sign\") {\n        payload.params = parsePersonalSign(payload.params);\n      }\n\n      if (callback) {\n        this.sendAsync(payload, callback);\n        return;\n      }\n\n      return this.sendAsyncPromise(payload.method, payload.params);\n    };\n\n    this.onConnect = callback => {\n      this.connectCallbacks.push(callback);\n    };\n\n    this.triggerConnect = result => {\n      if (this.connectCallbacks && this.connectCallbacks.length) {\n        this.connectCallbacks.forEach(callback => callback(result));\n      }\n    };\n\n    this.bridge = opts.connector ? opts.connector.bridge : opts.bridge || \"https://bridge.walletconnect.org\";\n    this.qrcode = typeof opts.qrcode === \"undefined\" || opts.qrcode !== false;\n    this.qrcodeModal = opts.qrcodeModal || this.qrcodeModal;\n    this.qrcodeModalOptions = opts.qrcodeModalOptions;\n    this.wc = opts.connector || new WalletConnect({\n      bridge: this.bridge,\n      qrcodeModal: this.qrcode ? this.qrcodeModal : undefined,\n      qrcodeModalOptions: this.qrcodeModalOptions,\n      storageId: opts === null || opts === void 0 ? void 0 : opts.storageId,\n      signingMethods: opts === null || opts === void 0 ? void 0 : opts.signingMethods,\n      clientMeta: opts === null || opts === void 0 ? void 0 : opts.clientMeta\n    });\n    this.rpc = opts.rpc || null;\n    this.infuraId = opts.infuraId || \"\";\n    this.chainId = parseToETHChainId((opts === null || opts === void 0 ? void 0 : opts.chainId) || this.chainId);\n    this.initialize();\n  }\n\n  get chainType() {\n    return this.wc.chainType;\n  }\n\n  get isWalletConnect() {\n    return true;\n  }\n\n  get connector() {\n    return this.wc;\n  }\n\n  get walletMeta() {\n    return this.wc.peerMeta;\n  }\n\n  async disconnect() {\n    this.close();\n  }\n\n  async close() {\n    const wc = await this.getWalletConnector({\n      disableSessionCreation: true\n    });\n    await wc.killSession();\n    await this.onDisconnect();\n  }\n\n  async handleRequest(payload) {\n    try {\n      let response;\n      let result = null;\n      const wc = await this.getWalletConnector({\n        disableSessionCreation: true\n      });\n\n      switch (payload.method) {\n        case \"dc_killSession\":\n          await this.close();\n          result = null;\n          break;\n\n        case \"eth_accounts\":\n          result = wc.accounts;\n          break;\n\n        case \"eth_coinbase\":\n          result = wc.accounts[0];\n          break;\n\n        case \"eth_chainId\":\n          result = parseToETHChainId(wc.chainId);\n          break;\n\n        case \"net_version\":\n          result = wc.chainId;\n          break;\n\n        case \"eth_uninstallFilter\":\n          this.sendAsync(payload, _ => _);\n          result = true;\n          break;\n\n        default:\n          response = await this.handleOtherRequests(payload);\n      }\n\n      if (response) {\n        return response;\n      }\n\n      return this.formatResponse(payload, result);\n    } catch (error) {\n      this.emit(\"error\", error);\n      throw error;\n    }\n  }\n\n  async handleOtherRequests(payload) {\n    if (!signingMethods.includes(payload.method) && payload.method.startsWith(\"eth_\")) {\n      return this.handleReadRequests(payload);\n    }\n\n    const wc = await this.getWalletConnector({\n      disableSessionCreation: true\n    });\n    const result = await wc.sendCustomRequest(payload);\n    return this.formatResponse(payload, result);\n  }\n\n  async handleReadRequests(payload) {\n    if (!this.http) {\n      return this.formatResponse(payload, {});\n    }\n\n    return this.http.send(payload);\n  }\n\n  formatResponse(payload, result) {\n    return {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      result: result\n    };\n  }\n\n  getWalletConnector() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const {\n      disableSessionCreation = false\n    } = opts;\n    return new Promise((resolve, reject) => {\n      const wc = this.wc;\n\n      if (this.isConnecting) {\n        this.onConnect(x => resolve(x));\n      } else if (!wc.connected && !disableSessionCreation) {\n        this.isConnecting = true;\n        wc.on(\"modal_closed\", () => {\n          reject(new Error(\"User closed modal\"));\n        });\n        wc.createSession({\n          chainId: this.chainId\n        }).then(() => {\n          wc.on(\"connect\", (error, payload) => {\n            if (error) {\n              this.isConnecting = false;\n              return reject(error);\n            }\n\n            this.isConnecting = false;\n            this.connected = true;\n\n            if (payload) {\n              this.updateState(payload.params[0]);\n            }\n\n            this.emit(\"connect\");\n            this.triggerConnect(wc);\n            resolve(wc);\n          });\n        }).catch(error => {\n          this.isConnecting = false;\n          reject(error);\n        });\n      } else {\n        if (!this.connected) {\n          this.connected = true;\n          this.updateState(wc.session);\n        }\n\n        resolve(wc);\n      }\n    });\n  }\n\n  async subscribeWalletConnector() {\n    const wc = await this.getWalletConnector();\n    wc.on(\"disconnect\", error => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n\n      this.onDisconnect();\n    });\n    wc.on(\"session_update\", (error, payload) => {\n      if (error) {\n        this.emit(\"error\", error);\n        return;\n      }\n\n      this.updateState(payload.params[0]);\n    });\n  }\n\n  async onDisconnect() {\n    await this.stop();\n    this.emit(\"close\", 1000, \"Connection closed\");\n    this.emit(\"disconnect\", 1000, \"Connection disconnected\");\n    this.connected = false;\n  }\n\n  async updateState(sessionParams) {\n    const {\n      accounts,\n      chainId,\n      chainType,\n      networkId,\n      rpcUrl\n    } = sessionParams;\n\n    if (!this.accounts || accounts && this.accounts !== accounts) {\n      this.accounts = accounts;\n      this.emit(\"accountsChanged\", accounts);\n    }\n\n    if (!this.chainId || chainId && this.chainId !== chainId) {\n      this.chainId = parseToETHChainId(chainId);\n      this.emit(\"chainChanged\", this.chainId);\n    }\n\n    if (!this.networkId || networkId && this.networkId !== networkId) {\n      this.networkId = networkId;\n      this.emit(\"networkChanged\", networkId);\n    }\n\n    this.updateRpcUrl(this.chainId, chainType, rpcUrl || \"\");\n  }\n\n  updateRpcUrl(chainId, chainType) {\n    let rpcUrl = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n    const rpc = {\n      infuraId: this.infuraId,\n      custom: this.rpc || undefined\n    };\n    rpcUrl = rpcUrl || getRpcUrl(chainId, rpc);\n\n    if (rpcUrl) {\n      this.rpcUrl = rpcUrl;\n      this.updateHttpConnection();\n    } else {\n      this.http = null;\n    }\n  }\n\n  updateHttpConnection() {\n    if (this.rpcUrl) {\n      this.http = new HttpConnection(this.rpcUrl);\n      this.http.on(\"payload\", payload => this.emit(\"payload\", payload));\n      this.http.on(\"error\", error => this.emit(\"error\", error));\n    }\n  }\n\n  sendAsyncPromise(method, params) {\n    return new Promise((resolve, reject) => {\n      this.sendAsync({\n        id: payloadId(),\n        jsonrpc: \"2.1\",\n        method,\n        params: params || []\n      }, (error, response) => {\n        if (error) {\n          reject(error);\n          return;\n        }\n\n        resolve(response.result);\n      });\n    });\n  }\n\n  initialize() {\n    this.updateRpcUrl(this.chainId, this.chainType);\n    this.addProvider(new FixtureSubprovider({\n      eth_hashrate: \"0x00\",\n      eth_mining: false,\n      eth_syncing: true,\n      net_listening: true,\n      web3_clientVersion: `WalletConnect/v1.x.x/javascript`\n    }));\n    this.addProvider(new CacheSubprovider());\n    this.addProvider(new SubscriptionsSubprovider());\n    this.addProvider(new FilterSubprovider());\n    this.addProvider(new NonceSubprovider());\n    this.addProvider(new HookedWalletSubprovider(this.configWallet()));\n    this.addProvider({\n      handleRequest: async (payload, next, end) => {\n        try {\n          const {\n            error,\n            result\n          } = await this.handleRequest(payload);\n          end(error, result);\n        } catch (error) {\n          end(error);\n        }\n      },\n      setEngine: _ => _\n    });\n  }\n\n  configWallet() {\n    return {\n      getAccounts: async cb => {\n        try {\n          const wc = await this.getWalletConnector();\n          const accounts = wc.accounts;\n\n          if (accounts && accounts.length) {\n            cb(null, accounts);\n          } else {\n            cb(new Error(\"Failed to get accounts\"));\n          }\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signMessage([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processPersonalMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signPersonalMessage([msgParams.data, msgParams.from]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processSignTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTransaction: async (txParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.sendTransaction(txParams);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      },\n      processTypedMessage: async (msgParams, cb) => {\n        try {\n          const wc = await this.getWalletConnector();\n          const result = await wc.signTypedData([msgParams.from, msgParams.data]);\n          cb(null, result);\n        } catch (error) {\n          cb(error);\n        }\n      }\n    };\n  }\n\n}\n\nexport default WalletConnectProvider;","map":{"version":3,"mappings":"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","names":["WalletConnect","QRCodeModal","HttpConnection","payloadId","signingMethods","parsePersonalSign","getRpcUrl","ProviderEngine","require","CacheSubprovider","FixtureSubprovider","FilterSubprovider","HookedWalletSubprovider","NonceSubprovider","SubscriptionsSubprovider","parseToETHChainId","chainId","parsed","parseInt","isNaN","error","WalletConnectProvider","constructor","opts","pollingInterval","undefined","wc","getWalletConnector","start","subscribeWalletConnector","accounts","Error","payload","send","callback","method","params","sendAsyncPromise","id","jsonrpc","sendAsync","connectCallbacks","push","result","length","forEach","bridge","connector","qrcode","qrcodeModal","qrcodeModalOptions","storageId","clientMeta","rpc","infuraId","initialize","chainType","isWalletConnect","walletMeta","peerMeta","disconnect","close","disableSessionCreation","killSession","onDisconnect","handleRequest","response","_","handleOtherRequests","formatResponse","emit","includes","startsWith","handleReadRequests","sendCustomRequest","http","Promise","resolve","reject","isConnecting","onConnect","x","connected","on","createSession","then","updateState","triggerConnect","catch","session","stop","sessionParams","networkId","rpcUrl","updateRpcUrl","custom","updateHttpConnection","addProvider","eth_hashrate","eth_mining","eth_syncing","net_listening","web3_clientVersion","configWallet","next","end","setEngine","getAccounts","cb","processMessage","msgParams","signMessage","from","data","processPersonalMessage","signPersonalMessage","processSignTransaction","txParams","signTransaction","processTransaction","sendTransaction","processTypedMessage","signTypedData"],"sourceRoot":"","sources":["../../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}